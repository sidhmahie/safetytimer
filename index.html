
<!DOCTYPE html>
<html><head><meta name="GCD" content="YTk3ODQ3ZWZhN2I4NzZmMzBkNTEwYjJla7247e24b645f6be6816733f2fc0004a"/>
  <meta charset="utf-8">
  <title>Keep Away !</title>
  <meta name="generator" content="Google Web Designer 14.0.4.1108">
  <style type="text/css" id="gwd-text-style">p {
    margin: 0px;
}
h1 {
    margin: 0px;
}
h2 {
    margin: 0px;
}
h3 {
    margin: 0px;
}</style>
  <style type="text/css">html,
body {
    width: 100%;
    height: 100%;
    margin: 0px;
}
body {
    background-color: transparent;
    transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
    -webkit-transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
    -moz-transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
    perspective: 1400px;
    -webkit-perspective: 1400px;
    -moz-perspective: 1400px;
    transform-style: preserve-3d;
    -webkit-transform-style: preserve-3d;
    -moz-transform-style: preserve-3d;
}
.gwd-img-1gsg {
    position: absolute;
    width: 400px;
    height: 600px;
    top: 45px;
    left: 328px;
}
.gwd-label-8tm9 {
    display: block;
    height: 20px;
    position: absolute;
    background-image: none;
    background-color: transparent;
    border-image-source: none;
    border-image-width: 1;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-color: transparent;
    font-family: Georgia;
    font-style: italic;
    font-size: 15px;
    text-align: center;
    width: 120px;
    left: 377px;
    top: 271px;
    color: rgb(172, 1, 1);
}
.gwd-select-um37 {
    display: block;
    position: absolute;
    width: 150px;
    height: 20px;
    left: 508px;
    background-image: none;
    top: 271px;
    border-image-source: none;
    border-image-width: 1;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-color: rgb(0, 3, 146);
    background-color: rgb(249, 250, 198);
}
.gwd-label-5xej {
    display: block;
    height: 20px;
    left: 644px;
    position: absolute;
    top: 324px;
    width: 100px;
}
.gwd-select-sqqw {
    display: block;
    height: 24px;
    left: 771px;
    position: absolute;
    top: 322px;
    width: 100px;
}
.gwd-label-8n7s {
    display: block;
    height: 20px;
    position: absolute;
    width: 120px;
    font-style: italic;
    font-family: Georgia;
    left: 375px;
    top: 345px;
    color: rgb(172, 1, 1);
}
.gwd-select-14mv {
    display: block;
    position: absolute;
    height: 20px;
    width: 50px;
    background-image: none;
    left: 608px;
    top: 345px;
    border-image-source: none;
    border-image-width: 1;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-color: rgb(118, 118, 118);
    background-color: rgb(249, 250, 198);
}
.gwd-button-1al5 {
    display: block;
    position: absolute;
    padding: 1px 6px;
    font-weight: bold;
    left: 384px;
    height: 50px;
    font-family: Georgia;
    font-style: italic;
    width: 80px;
    background-image: none;
    color: rgb(0, 0, 0);
    border-image-source: none;
    border-image-width: 1;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-color: rgb(0, 0, 0);
    font-size: 18px;
    top: 387px;
    background-color: rgb(255, 207, 207);
}
.gwd-select-qh8n {
    height: 20px;
    width: 150px;
    background-image: none;
    left: 508px;
    top: 308px;
    border-image-source: none;
    border-image-width: 1;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-color: rgb(0, 0, 0);
    background-color: rgb(249, 250, 198);
}
.gwd-label-10kj {
    font-family: Georgia;
    font-style: italic;
    text-align: center;
    width: 125px;
    left: 372px;
    top: 308px;
    color: rgb(172, 1, 1);
}
.gwd-label-1d6f {
    position: absolute;
    height: 30px;
    font-family: Georgia;
    font-weight: bold;
    font-style: italic;
    width: 275px;
    text-align: center;
    left: 382px;
    font-size: 23px;
    color: rgb(172, 1, 1);
    top: 219px;
}
.gwd-button-enql {
    position: absolute;
    height: 50px;
    font-weight: bold;
    font-family: Georgia;
    font-style: italic;
    text-align: center;
    width: 80px;
    background-image: none;
    border-image-source: none;
    border-image-width: 1;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-color: rgb(0, 0, 0);
    color: rgb(0, 0, 0);
    font-size: 18px;
    left: 574px;
    top: 387px;
    background-color: rgb(255, 207, 207);
}
.gwd-label-1kpf {
    position: absolute;
    font-size: 40px;
    text-align: center;
    background-image: none;
    background-color: transparent;
    width: 260px;
    height: 40px;
    left: 389px;
    top: 448px;
}
.gwd-label-19uc {
    position: absolute;
    height: 50px;
    width: 100px;
    text-align: center;
    font-family: Georgia;
    font-weight: bold;
    font-style: italic;
    font-size: 20px;
    left: 469px;
    top: 387px;
    border-image-source: none;
    border-image-width: 1;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-color: transparent;
    color: rgb(172, 1, 1);
}</style>
  <script type="text/javascript">
    //GLOBAL VARIABLES
    var timer;
    const TIMER_INTERVAL_SEC = 1;
    const IGNORE_SEC_AFTER_MIN = 10;
    var safeTimeSec = 3600;
    var remainingTimeSec = 3600;
    var isWarningPlayed = false;
    var isDangerPlayed = false;
    /*
    Called by [Get Time] button. Calculates and displeys safe time for the given disease, distance and the type of exposure. 
    */
    function getSafeTime() {
      //REFERENCE DATA
      const ID50_MAP = new Map();
      ID50_MAP.set("AL", 40);
      ID50_MAP.set("IN", 127);
      ID50_MAP.set("OM", 20);

      //EXPERIMENTAL DATA
      const PPM_MAP = new Map();
      //COVID-19 Alpha, Nose exposure
      PPM_MAP.set("ALNO01", 51.89);
      PPM_MAP.set("ALNO02", 28.58);
      PPM_MAP.set("ALNO03", 12.01);
      PPM_MAP.set("ALNO04", 1.85);
      PPM_MAP.set("ALNO05", 0.34);
      PPM_MAP.set("ALNO06", 0.15);
      PPM_MAP.set("ALNO07", 0.02);
      PPM_MAP.set("ALNO08", 0.00);
      //COVID-19 Alpha, Nose and mouth exposure
      PPM_MAP.set("ALNM01", 259.45);
      PPM_MAP.set("ALNM02", 142.88);
      PPM_MAP.set("ALNM03", 60.04);
      PPM_MAP.set("ALNM04", 9.23);
      PPM_MAP.set("ALNM05", 1.69);
      PPM_MAP.set("ALNM06", 0.76);
      PPM_MAP.set("ALNM07", 0.11);
      PPM_MAP.set("ALNM08", 0.02);
      //Influenza, Nose exposure
      PPM_MAP.set("INNO01", 7.78);
      PPM_MAP.set("INNO02", 4.28);
      PPM_MAP.set("INNO03", 1.80);
      PPM_MAP.set("INNO04", 0.28);
      PPM_MAP.set("INNO05", 0.05);
      PPM_MAP.set("INNO06", 0.02);
      PPM_MAP.set("INNO07", 0.00);
      PPM_MAP.set("INNO08", 0.00);
      //Influenza, Nose and mouth exposure
      PPM_MAP.set("INNM01", 38.92);
      PPM_MAP.set("INNM02", 21.43);
      PPM_MAP.set("INNM03", 9.00);
      PPM_MAP.set("INNM04", 1.38);
      PPM_MAP.set("INNM05", 0.25);
      PPM_MAP.set("INNM06", 0.11);
      PPM_MAP.set("INNM07", 0.02);
      PPM_MAP.set("INNM08", 0.00);

      //USER INPUTS
      var exposure = document.getElementById('select_exposure').selectedOptions[0].value;
      var disease = document.getElementById('select_disease').selectedOptions[0].value;
      var distance = document.getElementById('select_distance').selectedOptions[0].value;

      //TIME CALCULATION
      var id50 = ID50_MAP.get(disease);

      // Assuming all COVID variants have same density in a droplet
      if (disease == "OM") {
        disease = "AL";
      }

      var situation = disease + exposure + distance;
      var ppm = PPM_MAP.get(situation);
      //Approximate to avoid dividing by zero
      if (ppm == 0.00) {
        ppm = 0.01;
      }
      var safeTimeMin = (id50 / ppm); //!!!
      safeTimeSec = Math.round(safeTimeMin * 60);

      //DISPLAY SAFE TIME
      document.getElementById('safe_time_display').innerHTML = getDisplayTime(safeTimeSec);
      //document.getElementById('button_getTime').disabled = true;


    };

    /*
    Called by [Start Timer] button. Updates remaining time every TIMER_INTERVAL_SEC.
    */
    function startSafeTimer() {
      if (timer != null) {
        clearInterval(timer);
      }
      remainingTimeSec = safeTimeSec;
      var outputLabel = document.getElementById('remaining_time_display');
      outputLabel.innerHTML = getDisplayTime(remainingTimeSec);
      outputLabel.style.color = "black"
      outputLabel.style.backgroundColor = "transparent"
      timer = setInterval(checkRemainingTime, TIMER_INTERVAL_SEC * 1000);

    };

    /*
    Tracks if the timer is expired. Applies color coding based on the remaining time.
    */
    function checkRemainingTime() {
      remainingTimeSec = remainingTimeSec - TIMER_INTERVAL_SEC;
      var outputLabel = document.getElementById('remaining_time_display');
      if (remainingTimeSec < 0) {
        //TIMER EXPIRED
        remainingTimeSec = 0;
        clearInterval(timer);
        outputLabel.innerHTML = "";
        outputLabel.style.backgroundColor = "transparent";
      } else {

        outputLabel.innerHTML = getDisplayTime(remainingTimeSec);

        //COLOR CODING AND MUSIC
        outputLabel.style.color = "white";

        if ((remainingTimeSec < 10) && (isDangerPlayed == false)) {
          document.getElementById('audio_danger').play();
          isDangerPlayed = true;
        }

        if (remainingTimeSec < 30) {
          outputLabel.style.backgroundColor = "red";
          if (isWarningPlayed == false) {
            document.getElementById('audio_warning').play();
            isWarningPlayed = true;
          }
        } else if (remainingTimeSec < 60) {
          outputLabel.style.backgroundColor = "orange";
        } else if (remainingTimeSec < 120) {
          outputLabel.style.backgroundColor = "yellow";
          outputLabel.style.color = "black";
        } else {
          outputLabel.style.backgroundColor = "green";
        }
      }
    };

    /*
   Utility function - called from multiple places
    */
    function getDisplayTime(givenTimeSec) {
      var min = Math.floor(givenTimeSec / 60);
      var sec = givenTimeSec % 60;
      var minDisplay = "";
      var secDisplay = "";
      if (min > 0) {
        minDisplay = min + " min ";
      }
      if (min < IGNORE_SEC_AFTER_MIN) {
        if (sec > 0) {
          secDisplay = sec + " sec ";
        }
      }
      return safeTimeDisplay = minDisplay + secDisplay;
    }
  </script>
</head>

<body class="htmlNoPages">
  <img src="apple-watch.png" id="apple-watch" class="gwd-img-1gsg">
  <label id="label_title" class="gwd-label-1d6f">Mahie's Safety Timer</label>
  <label id="label_exposure" class="gwd-label-8tm9">Portals of Entry</label>
  <select id="select_exposure" class="gwd-select-um37">
    <option value="NO" selected="">Nose</option>
    <option value="NM">Nose &amp; Mouth</option>
  </select>
  <label id="label_disease" class="gwd-label-5xej gwd-label-1ow5 gwd-label-10kj">Patient's Disease</label>
  <select id="select_disease" class="gwd-select-sqqw gwd-select-ga1e gwd-select-qh8n">
    <option value="AL" selected="">COVID-19 (Alpha)</option>
    <option value="IN">Influenza</option>
    <option value="OM">COVID-19 (Omicron)</option>
  </select>
  <label id="label_distance" class="gwd-label-5xej gwd-label-8n7s">Distance (feet)</label>
  <select id="select_distance" class="gwd-select-sqqw gwd-select-14mv">
    <option value="01" selected="">1</option>
    <option value="02">2</option>
    <option value="03">3</option>
    <option value="04">4</option>
    <option value="05">5</option>
    <option value="06">6</option>
    <option value="07">7</option>
    <option value="08">8</option>
  </select>
  <button id="button_getTime" class="gwd-button-1al5" onclick="getSafeTime()">Get Time</button>
  <label id="safe_time_display" class="gwd-label-19uc"></label>
  <button id="button_startTimer" class="gwd-button-enql" onclick="startSafeTimer()">Start Timer</button>
  <label id="remaining_time_display" class="gwd-label-1kpf"></label>
  <audio id="audio_danger" src="tuu-oo-ii.wav" style="display: none;" controls=""></audio>
  <audio id="audio_warning" src="tino-nino-wee.wav" style="display: none;" controls=""></audio>


</body></html>
